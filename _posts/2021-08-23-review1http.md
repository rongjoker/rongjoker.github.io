---
layout: post
title: 温故知新之HTTP
---


### 短连接 VS 长连接

通常的认知里，http是无状态的，可以看作短连接。可是在http1.1发布之初(1996年6月)即支持长连接（PersistentConnection）和请求的流水线（Pipelining），
2.0更是直接支持了复用。<br>
h1和h2的时代，http的传输层都采用了tcp协议。HTTP/1.0 的默认模型是短连接。短连接有两大缺点。其一是每一个 HTTP 请求都会有一次 TCP 握手，耗费了巨大的创建连接的时间；其二是 TCP 连接的性能只有在连接被使用一段时间后(热连接)才能得到改善。为了缓解这些问题，长连接 的概念便被设计出来了，甚至在 HTTP/1.1 之前。或者这被称之为一个 keep-alive 连接。<br>
一个长连接会保持一段时间，重复用于发送一系列请求，节省了新建 TCP 连接握手的时间，还可以利用 TCP 的性能增强能力。当然这个连接也不会一直保留着：连接在空闲一段时间后会被关闭(服务器可以使用 Keep-Alive 协议头来指定一个最小的连接保持时间)。
<br>
长连接也还是有缺点的；就算是在空闲状态，它还是会消耗服务器资源，而且在重负载时，还有可能遭受 DoS attacks 攻击。这种场景下，可以使用非长连接，即尽快关闭那些空闲的连接，也能对性能有所提升。
<br>HTTP/1.1默认为长连接。
<br>
[![hpWHHA.md.png](https://z3.ax1x.com/2021/08/22/hpWHHA.md.png)](https://imgtu.com/i/hpWHHA)
<br>

### 流水线(pipelining) VS 多路复用(multiplexing)
HTTP/1.1 所支持的流水线功能并非默认开启,原因是正确的实现流水线是复杂的

> https://www.ianlewis.org/ 此网站使用了h2协议


> 《图解HTTP》


